{% extends "base.html" %}
{% load staticfiles %}
{% load schedules %}

{% block head %}

<link rel="stylesheet" href="{% static 'frontend/built/style/data_explorer.min.css' %}">

<!--[if IE 9]>
  <script src="{% static 'frontend/js/vendor/vex.combined.min.js' %}"></script>
  <script {{ csp_nonce }}>vex.defaultOptions.className = 'vex-theme-default';</script>
  <link rel="stylesheet" href="{% static 'frontend/style/vendor/vex.css' %}" />
  <link rel="stylesheet" href="{% static 'frontend/style/vendor/vex-theme-default.css' %}" />
<![endif]-->
{% endblock %}

{% block header_extension %}
<div class="row">
  <div class="twelve columns">
    <h1 class="description-main">Search awarded ceiling rates for labor categories</h1>
    <h2 class="description-secondary">CALC lets you conduct market research on professional service labor categories quickly and easily, helping you make better informed decisions. Results shown are awarded hourly rates from GSA IDIQ service schedules.</h2>

    <div class="row price-callout">
      <div class="three columns">
        <div class="icon icon-ceiling"></div>
        <p>Ceiling prices</p>
        <p>Maximum prices paid</p>
      </div>
      <div class="three columns">
        <div class="icon icon-fully-burdened"></div>
        <p>Fully burdened costs</p>
        <p>Wages + additional labor costs</p>
      </div>
      <div class="three columns">
        <div class="icon icon-professional-services"></div>
        <p>Professional services</p>
        <p>GSA schedule data</p>
      </div>
      <div class="three columns">
        <div class="icon icon-worldwide-rates"></div>
        <p>Worldwide rates</p>
        <p>Globally applicable rates</p>
      </div>
    </div>
  </div>
</div>
{% endblock header_extension %}

{% block body %}
<form id="search" class="search" role="form">
  <input type="hidden" name="sort" value="current_price">
  <input type="hidden" name="exclude" value="">

  <section class="search">
    <div class="container">
      <p class="help-text">Enter your search terms below, separated by commas. (For example: Engineer, Consultant)</p>
      <div class="row">
        <div class="six columns">
          <input id="labor_category" name="q" placeholder="Type a labor category" class="search u-full-width" type="text">
          <label for="labor_category" style="display:none;">Type a labor category</label>
          <div id="query-types">
            <input id="query_type_match_all" type="radio" name="query_type" value="match_all" checked>
            <label for="query_type_match_all">Contains words</label>

            <input id="query_type_match_phrase" type="radio" name="query_type" value="match_phrase">
            <label for="query_type_match_phrase">Contains phrase</label>

            <input id="query_type_match_exact" type="radio" name="query_type" value="match_exact">
            <label for="query_type_match_exact">Exact match</label>
          </div>
        </div>
        <div class="six columns">
          <button id="submit-button" class="submit button-primary">Search</button>
          <input id="reset-button" class="reset button" type="reset" value="Clear search">
        </div>
      </div><!-- /.row -->
    </div><!-- /.container -->
  </section><!-- /.search -->

  <section class="results">
    <div class="container">
      <div class="row">

        <div class="filter-container columns three">

          <div class="filter-block">

            <h5 class="filter-title">Optional filters</h5>

            <div id="education-level" data-embed-jsx="EducationLevel"></div>

            <div id="experience" data-embed-jsx="Experience"></div>

            <div class="filter filter-site">
              <label for="site">Worksite:</label>
              <select id="site" name="site">
                <option value="">(all)</option>
                <option value="customer">customer</option>
                <option value="contractor">contractor</option>
                <option value="both">both</option>
              </select>
            </div>

            <div class="filter filter-business_size">
              <label for="business_size">Business size:</label>
              <select id="business_size" name="business_size">
                <option value="">(all)</option>
                <option value="s" data-label="small">small business</option>
                <option value="o">other than small</option>
              </select>
            </div>

            <div class="filter filter-schedule">
              <label for="schedule">Schedule:</label>
              <a href="/about#schedules" class="filter-more-info">What's this?</a>
              <select id="schedule" name="schedule">
                <option value="">(all)</option>
                <option value="Consolidated">Consolidated</option>
                {% get_schedules as schedules %}
                {% for schedule in schedules %}
                  <option value="{{schedule.schedule}}">{{ schedule.SIN }} - {{ schedule.name }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="filter contract-year">

              <fieldset class="fieldset-inputs">

                <legend>Contract year:</legend>
                <a href="javascript:void(0)" class="tooltip filter-more-info" aria-label="All five years of pricing are available in the export">What's this?</a>
                <h3 class="sr-only">Contract Year</h3>

                <ul class="contract-year-block">
                  <li class="contract-list-item">
                    <label for="current-year" class="radio">
                      <input id="current-year" type="radio" checked name="contract-year" value="current" tabindex="0">
                      <span tabindex="-1" class="contract-current-year-span checkbox-focus" aria-hidden="true">Current</span>
                      <span class="sr-only">Current year</span>
                    </label>
                  </li>
                  <li class="contract-list-item">
                    <label for="one-year-out" class="radio">
                      <input id="one-year-out" type="radio" name="contract-year" value="1" tabindex="0">
                      <span tabindex="-1" class="checkbox-focus" aria-hidden="true">+1</span>
                      <span class="sr-only">One year out</span>
                    </label>
                  </li>
                  <li class="contract-list-item">
                    <label for="two-years-out" class="radio">
                      <input id="two-years-out" type="radio" name="contract-year" value="2" tabindex="0">
                      <span tabindex="-1" class="contract-last-year-span checkbox-focus" aria-hidden="true">+2</span>
                      <span class="sr-only">Two years out</span>
                    </label>
                  </li>
                </ul>

              </fieldset>

            </div>

            <!--
            <div class="filter">
              <label for="fiscal_year">Fiscal Year:</label>
              <select id="fiscal_year" name="fiscal_year">
              </select>
            </div>
            -->
          </div>

        </div>

        <div class="graph-block columns nine">
          <canvas id="graph" class="hidden" width="710" height="280"></canvas> <!-- for converting the histogram into an img -->
          <div id="description" data-embed-jsx="Description"></div>

          <h4>Hourly rate data</h4>

          <div id="proposed-price" data-embed-jsx="ProposedPrice"></div>

          <div class="loading-indicator">
            <p class="message">Loading results...</p>
            <div class="error-message"></div>
          </div>

          <div class="graph">
            <div id="price-histogram" data-embed-jsx="Histogram"></div>
          </div>

          <div id="highlights" data-embed-jsx="Highlights"></div>

          <div class="download-buttons row">
            <div class="four columns">
              <a id="download-histogram" class="button button-primary" href="#">⬇ Download graph</a>
            </div>

          <div id="results-actions four columns">
            <a id="export-data" class="button button-primary"
              title="Click to export your search results to an Excel file (CSV)" href="{{ API_HOST }}rates/csv/">⬇ Export Data (CSV)</a>
          </div>

          <p class="help-text">The rates shown here are fully burdened, applicable worldwide, and representative of the current fiscal year. This data represents rates awarded at the master contract level.</p>

        </div><!-- /.div -->

      </div><!-- /.row -->

      <div class="table-container">
        <table id="results-table" class="results has-data sortable hoverable">
          <thead>
            <tr>
              <th scope="col" class="exclude" data-key="exclude" data-format="">
                <span id="restore-excluded" data-embed-jsx="RestoreExcluded"></span>
              </th>
              <th scope="col" class="sortable tooltip" data-key="labor_category">Labor category</th>
              <th scope="col" class="sortable tooltip" data-key="education_level" title="Minimum years of education">Min&nbsp;edu.</th>
              <th scope="col" class="sortable tooltip" data-key="min_years_experience" title="Minimum years of experience">Experience</th>
              <th scope="col" class="sortable tooltip" data-key="current_price" title="Ceiling price" data-format="$%,.02f">Price</th>
              <th scope="col" data-key="idv_piid">Contract #</th>
              <th scope="col" class="sortable tooltip" data-key="vendor_name">Vendor</th>
              <th scope="col" class="sortable collapsible tooltip" data-key="schedule">Schedule</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="8">
                <a href="#results-table">Return to the top</a>
              </td>
          </tfoot>
        </table>
      </div>

    </div><!-- /.container -->
  </section><!-- /.results -->

</form>

<![if gt IE 8]>
{# For the list of files included in this built script, see gulpfile.js #}
<script src= "{% static 'frontend/built/js/data-explorer/vendor.min.js' %}"></script>
<script src= "{% static 'frontend/built/js/data-explorer/index.min.js' %}"></script>
<![endif]>

{% endblock %}
